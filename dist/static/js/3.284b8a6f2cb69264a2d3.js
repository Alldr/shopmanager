webpackJsonp([3],{"5zde":function(e,t,r){r("zQR9"),r("qyJz"),e.exports=r("FeBl").Array.from},Gu7T:function(e,t,r){"use strict";t.__esModule=!0;var a,n=r("c/Tr"),s=(a=n)&&a.__esModule?a:{default:a};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,s.default)(e)}},"c/Tr":function(e,t,r){e.exports={default:r("5zde"),__esModule:!0}},fBQ2:function(e,t,r){"use strict";var a=r("evD5"),n=r("X8DO");e.exports=function(e,t,r){t in e?a.f(e,t,n(0,r)):e[t]=r}},gQp0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),n=r.n(a),s=r("Gu7T"),i=r.n(s),l=r("exGp"),o=r.n(l),c={data:function(){return{loading:!1,roles:[],dialogVisible:!1,treeData:[],defaultProps:{children:"children",label:"authName"},checkedArr:[],currRoleId:-1}},created:function(){this.getRolesList()},methods:{setRights:function(){var e=this;return o()(n.a.mark(function t(){var r,a,s,l,o,c;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$refs.tree.getCheckedKeys(),a=e.$refs.tree.getHalfCheckedKeys(),s=[].concat(i()(r),i()(a)),t.next=5,e.$http.post("roles/"+e.currRoleId+"/rights",{rids:s.join(",")});case 5:l=t.sent,o=l.data.meta,c=o.msg,200===o.status&&(e.dialogVisible=!1,e.$message.success(c),e.getRolesList());case 8:case"end":return t.stop()}},t,e)}))()},showDia:function(e){var t=this;return o()(n.a.mark(function r(){var a,s;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.currRoleId=e.id,r.next=3,t.$http.get("rights/tree");case 3:a=r.sent,t.treeData=a.data.data,s=[],e.children.forEach(function(e){e.children.forEach(function(e){e.children.forEach(function(e){s.push(e.id)})})}),t.checkedArr=s,t.dialogVisible=!0;case 9:case"end":return r.stop()}},r,t)}))()},delRights:function(e,t){var r=this;return o()(n.a.mark(function a(){var s,i,l,o,c;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.$http.delete("roles/"+e.id+"/rights/"+t.id);case 2:s=a.sent,i=s.data,l=i.data,o=i.meta,c=o.msg,200===o.status&&(r.$message.success(c),e.children=l);case 5:case"end":return a.stop()}},a,r)}))()},getRolesList:function(){var e=this;return o()(n.a.mark(function t(){var r,a,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$http.get("roles");case 3:r=t.sent,a=r.data,s=a.data,200===a.meta.status&&(e.loading=!1,e.roles=s);case 6:case"end":return t.stop()}},t,e)}))()}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"card"},[r("my-bread",{attrs:{level1:"权限管理",level2:"角色列表"}}),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",[r("el-button",{attrs:{type:"primary",plain:""}},[e._v("添加角色")])],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.roles}},[r("el-table-column",{attrs:{type:"expand",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.children,function(a,n){return r("el-row",{key:n},[r("el-col",{attrs:{span:4}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){e.delRights(t.row,a)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-arrow-right"})],1),e._v(" "),r("el-col",{attrs:{span:20}},e._l(a.children,function(a,n){return r("el-row",{key:n},[r("el-col",{attrs:{span:4}},[r("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(r){e.delRights(t.row,a)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-arrow-right"})],1),e._v(" "),r("el-col",{attrs:{span:20}},e._l(a.children,function(a,n){return r("el-tag",{key:n,attrs:{closable:"",type:"warning"},on:{close:function(r){e.delRights(t.row,a)}}},[e._v(e._s(a.authName))])}),1)],1)}),1)],1)}),e._v(" "),0===t.row.children.length?r("el-row",[r("el-col",[r("span",[e._v("该角色未分配任何权限")])])],1):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{type:"index",label:"#",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色名称",prop:"roleName",width:"220"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc",width:"260"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-edit",circle:""}}),e._v(" "),r("el-button",{attrs:{size:"mini",plain:"",type:"danger",icon:"el-icon-delete",circle:""}}),e._v(" "),r("el-button",{attrs:{size:"mini",plain:"",type:"success",icon:"el-icon-check",circle:""},on:{click:function(r){e.showDia(t.row)}}})]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"分配权限",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-tree",{ref:"tree",attrs:{"default-expand-all":"",data:e.treeData,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-checked-keys":e.checkedArr}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.setRights()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(c,u,!1,function(e){r("yaPZ")},"data-v-fae33e72",null);t.default=d.exports},qyJz:function(e,t,r){"use strict";var a=r("+ZMJ"),n=r("kM2E"),s=r("sB3e"),i=r("msXi"),l=r("Mhyx"),o=r("QRG4"),c=r("fBQ2"),u=r("3fs2");n(n.S+n.F*!r("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,n,d,f=s(e),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,_=0,y=u(f);if(g&&(v=a(v,p>2?arguments[2]:void 0,2)),void 0==y||h==Array&&l(y))for(r=new h(t=o(f.length));t>_;_++)c(r,_,g?v(f[_],_):f[_]);else for(d=y.call(f),r=new h;!(n=d.next()).done;_++)c(r,_,g?i(d,v,[n.value,_],!0):n.value);return r.length=_,r}})},yaPZ:function(e,t){}});
//# sourceMappingURL=3.284b8a6f2cb69264a2d3.js.map