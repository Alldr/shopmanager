webpackJsonp([11],{"8ZAj":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),l=a("exGp"),s=a.n(l),i={data:function(){return{loading:!1,tableData:[],query:"",pagenum:1,pagesize:2,total:-1,dialogFormVisibleAdd:!1,dialogFormVisibleEdit:!1,dialogFormVisibleRole:!1,form:{username:"",password:"",email:"",mobile:""},formLabelWidth:"100px",currRoleId:"-1",roles:[],currUsername:"",currUserId:""}},created:function(){this.getTableData()},methods:{editRole:function(){var e=this;return s()(o.a.mark(function t(){var a,r,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("users/"+e.currUserId+"/role",{rid:e.currRoleId});case 2:a=t.sent,r=a.data.meta,l=r.msg,200===r.status&&(e.$message.success(l),e.dialogFormVisibleRole=!1);case 5:case"end":return t.stop()}},t,e)}))()},showRole:function(e){var t=this;return s()(o.a.mark(function a(){var r,l,s,i,n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.currUsername=e.username,t.currUserId=e.id,t.dialogFormVisibleRole=!0,a.next=5,t.$http.get("roles");case 5:return r=a.sent,l=r.data,s=l.meta.status,i=l.data,200===s&&(t.roles=i),a.next=10,t.$http.get("users/"+e.id);case 10:200===(n=a.sent).data.meta.status&&(t.currRoleId=n.data.data.rid);case 12:case"end":return a.stop()}},a,t)}))()},changeStatus:function(e){var t=this;return s()(o.a.mark(function a(){var r,l,s;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.put("users/"+e.id+"/state/"+e.mg_state);case 2:r=a.sent,l=r.data.meta,s=l.msg,200===l.status&&t.$message.success(s);case 5:case"end":return a.stop()}},a,t)}))()},editUser:function(){var e=this;return s()(o.a.mark(function t(){var a,r,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("users/"+e.form.id,e.form);case 2:a=t.sent,r=a.data.meta,l=r.msg,200===r.status&&(e.dialogFormVisibleEdit=!1,e.$message.success(l),e.getTableData());case 5:case"end":return t.stop()}},t,e)}))()},showUser:function(e){var t=this;return s()(o.a.mark(function a(){var r,l,s,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.dialogFormVisibleEdit=!0,a.next=3,t.$http.get("users/"+e.id);case 3:r=a.sent,l=r.data,s=l.data,i=l.meta,i.msg,200===i.status&&(t.form=s);case 6:case"end":return a.stop()}},a,t)}))()},delUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(s()(o.a.mark(function a(){var r,l,s;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("users/"+e.id);case 2:r=a.sent,l=r.data.meta,s=l.msg,l.status,t.$message.success(s),t.pagenum=1,t.getTableData();case 7:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message.info("已取消删除")})},addUser:function(){var e=this;return s()(o.a.mark(function t(){var a,r,l,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("users",e.form);case 2:a=t.sent,r=a.data,r.data,l=r.meta,s=l.msg,201===l.status&&(e.dialogFormVisibleAdd=!1,e.$message.success(s),e.pagenum=1,e.getTableData());case 5:case"end":return t.stop()}},t,e)}))()},showDialog:function(){this.form={},this.dialogFormVisibleAdd=!0},getAllUsers:function(){this.getTableData()},searchUser:function(){this.pagenum=1,this.getTableData()},handleSizeChange:function(e){this.pagenum=1,this.pagesize=e,this.getTableData()},handleCurrentChange:function(e){this.pagenum=e,this.getTableData()},getTableData:function(){var e=this;return s()(o.a.mark(function t(){var a,r,l,s,i,n,c;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$http.get("users?query="+e.query+"&pagesize="+e.pagesize+"&pagenum="+e.pagenum);case 3:a=t.sent,r=a.data,l=r.data,s=l.total,i=l.users,n=r.meta,c=n.status,n.msg,200===c&&(e.loading=!1,e.tableData=i,e.total=s);case 6:case"end":return t.stop()}},t,e)}))()}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"card"},[a("my-bread",{attrs:{level1:"用户列表",level2:"用户详情"}}),e._v(" "),a("el-row",[a("el-col",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入用户名",clearable:""},on:{clear:function(t){e.getAllUsers()}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.searchUser()}},slot:"append"})],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showDialog()}}},[e._v("添加用户")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"300"}},[a("el-table-column",{attrs:{prop:"id",label:"#",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"姓名",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"电话",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("fmtDate")(t.row.create_time)))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户状态",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){e.changeStatus(t.row)}},model:{value:t.row.mg_state,callback:function(a){e.$set(t.row,"mg_state",a)},expression:"scope.row.mg_state"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.showUser(t.row)}}}),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.delUser(t.row)}}}),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",type:"success",icon:"el-icon-check",circle:""},on:{click:function(a){e.showRole(t.row)}}})]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pagenum,"page-sizes":[2,4,6,8],"page-size":2,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisibleAdd},on:{"update:visible":function(t){e.dialogFormVisibleAdd=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisibleAdd=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUser()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisibleEdit},on:{"update:visible":function(t){e.dialogFormVisibleEdit=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisibleEdit=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editUser()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"分配角色",visible:e.dialogFormVisibleRole},on:{"update:visible":function(t){e.dialogFormVisibleRole=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth}},[e._v(e._s(e.currUsername))]),e._v(" "),a("el-form-item",{attrs:{label:"角色","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.currRoleId,callback:function(t){e.currRoleId=t},expression:"currRoleId"}},[a("el-option",{attrs:{disabled:"",label:"请选择",value:-1}}),e._v(" "),e._l(e.roles,function(e,t){return a("el-option",{key:t,attrs:{label:e.roleName,value:e.id}})})],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisibleRole=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editRole()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(i,n,!1,function(e){a("wfSp")},"data-v-13956921",null);t.default=c.exports},wfSp:function(e,t){}});
//# sourceMappingURL=11.4c40007a62f35ad2b32e.js.map